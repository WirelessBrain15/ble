<!-- <form> -->
    <button id="pair-el" onclick="isWebBluetoothEnabled()">Connect with BLE device</button>
  <!-- </form> -->

  <button id="start-el" onclick="bpTest()">START</button>

  <!-- <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.3.min.js">$("pair-el").click();</script> -->

  <script src="bleT.js">
    // deviceName = 'Contour7803H6996366';
    // primaryUUID = '00001808-0000-1000-8000-00805f9b34fb';
    // readUUID  = "00002a18-0000-1000-8000-00805f9b34fb";

    // deviceName1 = 'BP2941';
    // primaryUUID1 = '0000fff0-0000-1000-8000-00805f9b34fb';
    // writeUUID1 = "0000fff2-0000-1000-8000-00805f9b34fb";
    // readUUID1  = "0000fff1-0000-1000-8000-00805f9b34fb";

    // isSuccess = false;
    // isError = false;
    
    // const buffer = new ArrayBuffer(5);
    // const view = new DataView(buffer);
    // view.setInt8(0,0x00)
    // view.setInt8(1,0x02)
    // view.setInt8(2,0x03)
    // view.setInt8(3,0x40)
    // view.setInt8(4,0x45)

    // // if (isWebBluetoothEnabled()) {
    // //     document.getElementById('start-el').click();
    // //     // bleConnect()
    // //     }

    // function isWebBluetoothEnabled() {
    //     if (!navigator.bluetooth) {
    //       console.log('Web Bluetooth API is not available in this browser!')
    //       return false
    //     }
    
    //     return true
    //   }
    
    // //   -------------------------------------------------------------------------------------
    // async function bleConnect(){
    //     try{
    //         console.log('Requesting BLE devices... ');
    //         device1 = await navigator.bluetooth.requestDevice({
    //             filters: [{name: deviceName1}],
    //             optionalServices: [primaryUUID1]
    //         });

    //         device = await navigator.bluetooth.requestDevice({
    //             filters: [{name: deviceName}],
    //             optionalServices: [primaryUUID]
    //         });
            
    //         server1 = await device1.gatt.connect();
    //         console.log(`server1: ${server1}`)

    //         server = await device.gatt.connect();
    //         console.log(`server: ${server}`)

    //         // bpTest();
    //     }
    //     catch(error){
    //         console.log(`Failed, ${error}`);
    //     }
    // }

    // async function glucoTest()
    // {
    //     isSuccess = false;
    //     isError = false;

    //     if(device.gatt.connected)
    //         {
    //             console.log(device);
    //             // console.log("connected to ble");
    //             const service = await server.getPrimaryService(primaryUUID)
    //         }
            
            
    //     const service = await server.getPrimaryService(primaryUUID);
    //     inboundChar = await service.getCharacteristic(readUUID);

    //     console.log(inboundChar);

    //     await inboundChar.addEventListener('characteristicvaluechanged', handleCharacteristicValueChanged);
    //     console.log("after read");
    //     await inboundChar.startNotifications();
    // }

    // async function bpTest()
    // {
    //     isSuccess1 = false;
    //     isError1 = false;

    //     if(device1.gatt.connected)
    //         {
    //             console.log(device1);
    //             // console.log("connected to ble");
    //             const service = await server1.getPrimaryService("0000fff0-0000-1000-8000-00805f9b34fb")
    //         }
    //     else bleConnect();
            
    //     const service1 = await server1.getPrimaryService(primaryUUID1);
    //     inboundChar1 = await service1.getCharacteristic(readUUID1);
    //     outboundChar1 = await service1.getCharacteristic(writeUUID1);

    //     console.log(inboundChar1);
    //     console.log(outboundChar1);

    //     await outboundChar1.writeValueWithoutResponse(view);
    //     console.log(view.buffer);
    //     await inboundChar1.startNotifications();
    //     await inboundChar1.addEventListener('characteristicvaluechanged', handleCharacteristicValueChanged1);
    //     console.log("after read");
    //     await inboundChar1.startNotifications();

    //     const service = await server.getPrimaryService(primaryUUID);
    //     inboundChar = await service.getCharacteristic(readUUID);

    //     console.log(inboundChar);

    //     await inboundChar.addEventListener('characteristicvaluechanged', handleCharacteristicValueChanged);
    //     console.log("after read");
    //     await inboundChar.startNotifications();
    // }

    // async function handleCharacteristicValueChanged(event) {
    //     console.log("hello")
    //     const value = event.target.value;
    //     console.log("Length " + value.byteLength)
    //     for(var i = 0; i < value.byteLength; i++)
    //     {
    //         if (i == 12 && isError == false)
    //         {
    //             d1 = parseInt(value.getUint8(i), 16);
    //             console.log(` d1 >> ${d1}`);
    //         }
    //         else if (i == 13 && isError == false)
    //         {
    //             d2 = parseInt(value.getUint8(i), 16);
    //             console.log(` d2 >> ${d2}`);

    //             console.log(`result : ${(d2 - 374)*100 + d1}`)
    //         }
    //         // else if ()   //  Success or failure
    //         // {}
    //         else
    //         {
    //             console.log(` Received ${i} : ${value.getUint8(i).toString(16)}`);    
    //         }
    //     }
    // }

    // async function handleCharacteristicValueChanged1(event) {
    //     const value = event.target.value;
    //     // console.log("Length " + value.byteLength)
    //     for(var i = 0; i < value.byteLength; i++)
    //     {
    //         if (i == 2 && isError1 == false)
    //         {
    //             sys = parseInt(value.getUint8(i).toString(16), 16);
    //             console.log(` SYSTOLIC >> ${sys}`);
    //         }
    //         else if (i == 3 && isError1 == false)
    //         {
    //             dia = parseInt(value.getUint8(i).toString(16), 16);
    //             console.log(` DIASTOLIC >> ${dia}`);
    //         }
    //         else if (i == 4 && isError1 == false)
    //         {
    //             pul = parseInt(value.getUint8(i).toString(16), 16);
    //             console.log(` PULSE >> ${pul}`);
    //         }
    //         else if (i == 0 && isError1 == false && isSuccess1 == false)
    //         {
    //             num = parseInt(value.getUint8(i).toString(16), 16);
    //             if (num == 4)
    //             {
    //                 console.log('Test Finished')
    //                 isSuccess1 = true;
    //                 isError1 = false;
    //                 return;
    //             }
    //             if (num == 2)
    //             {
    //                 console.log('Error while measuring, please try again.')
    //                 isError1 = true;
    //                 isSuccess1 = false;
    //                 return;
    //             }
    //         }
    //         // if (isSuccess == true)
    //         // {
    //         //     console.log(` Received ${i} : ${value.getUint8(i).toString(16)}`);    
    //         // }
    //     }
    // }
    // //   -------------------------------------------------------------------------------------

    // // async function bleConnect(){
    // //     navigator.bluetooth.requestDevice({
    // //         filters: [{name: deviceName}],
    // //         optionalServices: [primaryUUID1]
    // //     })
    // //     .then(device => device.gatt.connect())
    // //     .then(server => server.getPrimaryService(primaryUUID1))
    // //     .then(service => service.getCharacteristic(readUUID1))
    // //     // .then(characteristic =>  characteristic.readValue())
    // // }
    // //   -------------------------------------------------------------------------------------

    // document.getElementById('pair-el').addEventListener('click', function(event) {
    //     event.stopPropagation()
    //     event.preventDefault()
    
    //     if (isWebBluetoothEnabled()) {
    //       bleConnect()
    //     }
    //   })

    // button = document.getElementById('start-el');
    // button.addEventListener('click',bpTest);  
      </script>
  <!-- <script src="index.js"></script> -->